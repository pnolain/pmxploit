<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate a NONMEM control stream with $PRIOR — nm_prior • pmxploit</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Generate a NONMEM control stream with $PRIOR — nm_prior" />

<meta property="og:description" content="Generates a NONMEM control stream for an analysis using prior information from a source run." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmxploit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pmxploit.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/nonmem_requirements.html">NONMEM control stream writing requirements</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate a NONMEM control stream with $PRIOR</h1>
    
    <div class="hidden name"><code>nm_prior.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generates a NONMEM control stream for an analysis using prior information from a source run.</p>
    
    </div>

    <pre class="usage"><span class='fu'>nm_prior</span>(<span class='no'>run</span>, <span class='kw'>df_formula</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>df_values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>output_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>dataset_filename</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>estimations</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>run</th>
      <td><p><code>pmxploit</code> NONMEM run object of the source run.</p></td>
    </tr>
    <tr>
      <th>df_formula</th>
      <td><p>integer. Formula to use for computation of degrees of freedom of OMEGA and SIGMA priors.</p></td>
    </tr>
    <tr>
      <th>output_file</th>
      <td><p>(optional) character. File path to write the generated
control stream to. Default is <code>NULL</code>, not saving any file.</p></td>
    </tr>
    <tr>
      <th>dataset_filename</th>
      <td><p>(optional) character. Name of the dataset to set in
the $DATA record of the generated control stream. Default is <code>NULL</code>,
leaving $DATA record as it is in the source run.</p></td>
    </tr>
    <tr>
      <th>estimations</th>
      <td><p>(optional) list. A list
containing the estimation record(s)
to set for the generated control stream. Each estimation record must be
represented by a list item containing the estimation settings as a named list.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A character string of the generated control stream code.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Control stream generation from pmxploit::EXAMPLERUN</span>
<span class='no'>cs1</span> <span class='kw'>&lt;-</span> <span class='fu'>nm_prior</span>(<span class='no'>EXAMPLERUN</span>)
<span class='co'># see the output</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/writeLines'>writeLines</a></span>(<span class='no'>cs1</span>)</div><div class='output co'>#&gt; ; Control stream generated for PRIOR analysis from:
#&gt; ; ~/pmxploit/example.tar.gz
#&gt; 
#&gt; $PROB  TMDD Qss model for alirocumab
#&gt; ; Reference:
#&gt; ; Djebli N, Martinez JM, Lohan L, Khier S, Brunet A, Hurbin F, et al.
#&gt; ; Target-mediated drug disposition population pharmacokinetics model of alirocumab in
#&gt; ; healthy volunteers and patients: pooled analysis of randomized phase I/II/III studies.
#&gt; ; Clin Pharmacokinet. 2017
#&gt; 
#&gt; $INPUT ;; Edit $INPUT to match the new dataset columns
#&gt; $DATA dataset.csv IGNORE=@
#&gt; 
#&gt; $SUBROUTINE ADVAN13 TOL=5
#&gt; 
#&gt; $PRIOR NWPRI
#&gt; 
#&gt; $MODEL NCOMP=4
#&gt; COMP=(DEPOT)
#&gt; COMP=(SARTOT)
#&gt; COMP=(TPCSK9)
#&gt; COMP=(PERIPH)
#&gt; 
#&gt; $PK
#&gt; 
#&gt; TVCL = THETA(1)
#&gt; TKON = THETA(2)
#&gt; TKIN = THETA(3)
#&gt; TKDE = THETA(4)
#&gt; TVQ  = THETA(5)
#&gt; TVV1 = THETA(6)
#&gt; TVV2 = THETA(7)
#&gt; TVKA = THETA(8)
#&gt; TVF  = THETA(9)
#&gt; TVEP = THETA(10)
#&gt; TVEA = THETA(11)
#&gt; TVLAG = THETA(12)
#&gt; COV1   = THETA(13)
#&gt; 
#&gt; 
#&gt; ETCL   = ETA(1)
#&gt; EKON   = ETA(2)
#&gt; EKIN   = ETA(3)
#&gt; EKDE   = ETA(4)
#&gt; ETQ    = ETA(5)
#&gt; ETV1   = ETA(6)
#&gt; ETV2   = ETA(7)
#&gt; ETKA   = ETA(8)
#&gt; ETF    = ETA(9)
#&gt; 
#&gt; 
#&gt; 
#&gt; CL   = TVCL * EXP(ETCL)
#&gt; KON  = TKON * EXP(EKON)
#&gt; KINT = TKIN * EXP(EKIN)
#&gt; KDEG = TKDE * EXP(EKDE)
#&gt; Q    = TVQ  * EXP(ETQ)
#&gt; 
#&gt; 
#&gt; 
#&gt; COV1V1 = TVV1 * COV1 ** DISST
#&gt; 
#&gt; V1 = COV1V1 * EXP(ETV1)
#&gt; 
#&gt; V2   = TVV2 * EXP(ETV2)
#&gt; KA   = TVKA * EXP(ETKA)
#&gt; ALAG1 = TVLAG
#&gt; 
#&gt; IF (ISC .EQ.0) THEN
#&gt; 
#&gt; F1=1
#&gt; ELSE
#&gt; PHI = LOG(TVF/(1-TVF))
#&gt; F1 = EXP(PHI+ETF)/(1+EXP(PHI+ETF))
#&gt; ENDIF
#&gt; 
#&gt; KEL = CL / V1
#&gt; KPT = Q / V1
#&gt; KTP = Q / V2
#&gt; 
#&gt; KSS = 0.58 + KINT/KON
#&gt; 
#&gt; SARBASE = 0
#&gt; KSYN = TBSPCSK * KDEG
#&gt; 
#&gt; A_0(2) = SARBASE
#&gt; A_0(3) = TBSPCSK * V1
#&gt; 
#&gt; S2=V1
#&gt; S3=V1
#&gt; 
#&gt; 
#&gt; 
#&gt; $DES
#&gt; C2=A(2)/V1
#&gt; C3=A(3)/V1
#&gt; C4=A(4)/V2
#&gt; DADT(1)= -KA * A(1) * ISC * F1
#&gt; 
#&gt; K1 = C2 - C3 - KSS
#&gt; SARF = 0.5*(K1+ SQRT(K1*K1 + 4*KSS*C2))
#&gt; 
#&gt; DADT(2)= KA*A(1)*ISC*F1-(KEL+KPT)*SARF*V1-KINT*A(3)*SARF/(KSS+SARF)+KTP*C4*V2
#&gt; 
#&gt; DADT(3)= KSYN  * V1 - KDEG * A(3)- (KINT - KDEG) * SARF * A(3)/(KSS + SARF)
#&gt; 
#&gt; DADT(4)= KPT* SARF * V1 - KTP * A(4)
#&gt; 
#&gt; ;A(1) = DOSE
#&gt; ;SARF = [SAR_LIBRE]
#&gt; ;A(2) = [SARtot]*V1
#&gt; ;A(3) = [PCSK9tot]*V1
#&gt; ;A(4) = [L tissulaire]*V2
#&gt; 
#&gt; ; PCSK9SAR = TPCSK9 * SARF/(KSS + SARF) =&gt; surprediction possible du complexe au
#&gt; ;tps initial !!!
#&gt; 
#&gt; $ERROR
#&gt; 
#&gt; IPRED=F
#&gt; SAV=0
#&gt; IF (IPRED.EQ.0) SAV=0.00001
#&gt; W=F
#&gt; IRES=DV-IPRED
#&gt; IWRES=IRES/(W+SAV)
#&gt; 
#&gt; Y=F+SQRT(TVEA*TVEA + TVEP*TVEP*F*F)*EPS(1)
#&gt; 
#&gt; $THETA ( 0.0 0.20 1000000.0 ) ; TVCL
#&gt; $THETA ( 559 559 559 ) ; TKON
#&gt; $THETA ( 0.0 0.25 1000000.0 ) ; TKIN
#&gt; $THETA ( 0.0 2.00 1000000.0 ) ; TKDE
#&gt; $THETA ( 0.0 1.00 1000000.0 ) ; TVQ
#&gt; $THETA ( 2.0 4.00 1000000.0 ) ; TVV1 SART
#&gt; $THETA (   2.612   2.612       2.612 ) ; TVV2
#&gt; $THETA ( 0.0 0.50 1000000.0 ) ; TVKA
#&gt; $THETA (   0.550   0.750       1.000 ) ; TVF
#&gt; $THETA ( 0.0 0.30 1000000.0 ) ; TVEP
#&gt; $THETA ( 0.0 0.05 1000000.0 ) ; TVEA
#&gt; $THETA ( 0.0 0.05  100) ; LAG
#&gt; $THETA 1 ; COV1
#&gt; 
#&gt; 
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0 FIX
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0 FIX
#&gt; $OMEGA 0.5
#&gt; $OMEGA 0.5
#&gt; 
#&gt; $SIGMA  1 FIX
#&gt; 
#&gt; 
#&gt; ; ================================================
#&gt; ; PRIOR INFORMATION
#&gt; ; ================================================
#&gt; ; THETA Priors -------------------------
#&gt; $THETAP
#&gt; 0.171896943763098     FIXED
#&gt; 559                   FIXED
#&gt; 0.123803201342408     FIXED
#&gt; 1.34635526853289      FIXED
#&gt; 0.50039445791587      FIXED
#&gt; 3.22590460107421      FIXED
#&gt; 2.612                 FIXED
#&gt; 0.637779367431747     FIXED
#&gt; 0.590001808531246     FIXED
#&gt; 0.274684075637132     FIXED
#&gt; 0.581795606608002     FIXED
#&gt; 0.0298266165438046    FIXED
#&gt; 1.56428570804632      FIXED
#&gt; ; Variance to THETA priors -------------
#&gt; $THETAPV BLOCK(13)
#&gt; 0.00023104719622956   FIXED
#&gt; 1e-09                 1e-09                
#&gt; -1.04034957452488e-05 1e-09                 4.94852473541275e-06 
#&gt; -0.000132380576300711 1e-09                 -2.17038124549764e-06 0.0014067543164689   
#&gt; 3.37273335283364e-05  1e-09                 -2.62117718892531e-05 -9.83509242784927e-05 0.00081696660001029  
#&gt; -0.000710872133743716 1e-09                 -5.80489374980969e-05 -0.000732628454663643 -0.000445920587930254 0.0415711705221499   
#&gt; 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                
#&gt; -0.000172472594375445 1e-09                 1.49084134799218e-05  0.000179969508697223  -0.000100076823054098 -0.00224596953903649  1e-09                 0.00218763549223713  
#&gt; 8.79808997968756e-05  1e-09                 -2.09503076577778e-05 -0.000106886489009519 4.53146822800296e-05  0.00309692392362989   1e-09                 -0.000478502787321484 0.000572988006168684 
#&gt; -1.16269709887021e-06 1e-09                 6.45639736622959e-07  -1.04783992387998e-05 -4.49284209190946e-06 8.68593698728809e-06  1e-09                 2.1408518826492e-06   -2.72270313463236e-06 2.26505265649685e-06 
#&gt; 3.97881008538303e-06  1e-09                 4.80556912014364e-07  2.78111595286765e-05  -3.57590444667545e-06 -4.77538174170191e-05 1e-09                 -6.15715850827622e-05 2.27771577491074e-06  -9.41191843254687e-06 0.000500919762819647 
#&gt; 5.45053324304558e-07  1e-09                 -1.7273759122248e-07  -1.94999218108576e-07 3.31278452211055e-06  9.25019594253438e-07  1e-09                 -7.15492047000474e-07 5.74018896478916e-08  -1.6453046982605e-07  5.38469288515014e-06  1.20876103617239e-06 
#&gt; 0.000507900274801002  1e-09                 -5.23098619372009e-05 -0.00029555530917814  0.000667518750332241  -0.0099825252948127   1e-09                 -0.000951749317422468 0.000240924919937593  -2.13162869496016e-05 3.10211676261024e-05  1.05759826160997e-06  0.00723573763017683  
#&gt; ; OMEGA Priors -------------------------
#&gt; $OMEGAP
#&gt; 0.279195982109823     FIXED
#&gt; 0                     FIXED
#&gt; 0.0580908084573451    FIXED
#&gt; 0.170534475475969     FIXED
#&gt; 0.0691065862986685    FIXED
#&gt; 0.0990369682744904    FIXED
#&gt; 0                     FIXED
#&gt; 0.464462143306044     FIXED
#&gt; 0.289551101707683     FIXED
#&gt; ; Degrees of freedom of OMEGA Prior ----
#&gt; $OMEGAPD
#&gt; 27                    FIXED ; ETCL
#&gt; 0                     FIXED ; EKON
#&gt; 316                   FIXED ; EKIN
#&gt; 216                   FIXED ; EKDE
#&gt; 11                    FIXED ; ETQ
#&gt; 71                    FIXED ; ETV1
#&gt; 0                     FIXED ; ETV2
#&gt; 176                   FIXED ; ETKA
#&gt; 33                    FIXED ; ETF
#&gt; ; SIGMA Priors -------------------------
#&gt; $SIGMAP
#&gt; 1                     FIXED
#&gt; ; Degrees of freedom of SIGMA Prior ----
#&gt; $SIGMAPD
#&gt; 0                     FIXED ; EPS1
#&gt; ; ======================================
#&gt; $ESTIMATION METHOD=1 INTERACTION PRINT=1 MAXEVAL=9999 NOABORT POSTHOC
#&gt; 
#&gt; $COVARIANCE PRINT=E MATRIX=S
#&gt; 
#&gt; $TAB ID TIME DV IPRED PRED CMT IRES CWRES IWRES NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=sdtab
#&gt; $TAB ID TIME CL KON KSS KINT KDEG Q V1 V2 KA ALAG1 F1 ETAS(1:LAST) NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=patab
#&gt; $TAB ID TIME AGE WT BMI CLCR GFR BSLDLC TBSPCSK FBSPCSK NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=cotab
#&gt; $TAB ID TIME ISC DISST SEX FIBR EZE STATIN ARM ABDO THIGH STUD NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=catab
#&gt; </div><div class='input'>
<span class='co'># Use prior information with "new_dataset.csv" and save the control stream to "new_study.ctl"</span>
<span class='fu'>nm_prior</span>(<span class='no'>EXAMPLERUN</span>, <span class='kw'>output_file</span> <span class='kw'>=</span> <span class='st'>"new_study.ctl"</span>, <span class='kw'>dataset_filename</span> <span class='kw'>=</span> <span class='st'>"new_dataset.csv"</span>)</div><div class='output co'>#&gt; [1] "; Control stream generated for PRIOR analysis from:\n; ~/pmxploit/example.tar.gz\n\n$PROB  TMDD Qss model for alirocumab\n; Reference:\n; Djebli N, Martinez JM, Lohan L, Khier S, Brunet A, Hurbin F, et al.\n; Target-mediated drug disposition population pharmacokinetics model of alirocumab in\n; healthy volunteers and patients: pooled analysis of randomized phase I/II/III studies.\n; Clin Pharmacokinet. 2017\n\n$INPUT ;; Edit $INPUT to match the new dataset columns\n$DATA new_dataset.csv IGNORE=@\n\n$SUBROUTINE ADVAN13 TOL=5\n\n$PRIOR NWPRI\n\n$MODEL NCOMP=4\nCOMP=(DEPOT)\nCOMP=(SARTOT)\nCOMP=(TPCSK9)\nCOMP=(PERIPH)\n\n$PK\n\nTVCL = THETA(1)\nTKON = THETA(2)\nTKIN = THETA(3)\nTKDE = THETA(4)\nTVQ  = THETA(5)\nTVV1 = THETA(6)\nTVV2 = THETA(7)\nTVKA = THETA(8)\nTVF  = THETA(9)\nTVEP = THETA(10)\nTVEA = THETA(11)\nTVLAG = THETA(12)\nCOV1   = THETA(13)\n\n\nETCL   = ETA(1)\nEKON   = ETA(2)\nEKIN   = ETA(3)\nEKDE   = ETA(4)\nETQ    = ETA(5)\nETV1   = ETA(6)\nETV2   = ETA(7)\nETKA   = ETA(8)\nETF    = ETA(9)\n\n\n\nCL   = TVCL * EXP(ETCL)\nKON  = TKON * EXP(EKON)\nKINT = TKIN * EXP(EKIN)\nKDEG = TKDE * EXP(EKDE)\nQ    = TVQ  * EXP(ETQ)\n\n\n\nCOV1V1 = TVV1 * COV1 ** DISST\n\nV1 = COV1V1 * EXP(ETV1)\n\nV2   = TVV2 * EXP(ETV2)\nKA   = TVKA * EXP(ETKA)\nALAG1 = TVLAG\n\nIF (ISC .EQ.0) THEN\n\nF1=1\nELSE\nPHI = LOG(TVF/(1-TVF))\nF1 = EXP(PHI+ETF)/(1+EXP(PHI+ETF))\nENDIF\n\nKEL = CL / V1\nKPT = Q / V1\nKTP = Q / V2\n\nKSS = 0.58 + KINT/KON\n\nSARBASE = 0\nKSYN = TBSPCSK * KDEG\n\nA_0(2) = SARBASE\nA_0(3) = TBSPCSK * V1\n\nS2=V1\nS3=V1\n\n\n\n$DES\nC2=A(2)/V1\nC3=A(3)/V1\nC4=A(4)/V2\nDADT(1)= -KA * A(1) * ISC * F1\n\nK1 = C2 - C3 - KSS\nSARF = 0.5*(K1+ SQRT(K1*K1 + 4*KSS*C2))\n\nDADT(2)= KA*A(1)*ISC*F1-(KEL+KPT)*SARF*V1-KINT*A(3)*SARF/(KSS+SARF)+KTP*C4*V2\n\nDADT(3)= KSYN  * V1 - KDEG * A(3)- (KINT - KDEG) * SARF * A(3)/(KSS + SARF)\n\nDADT(4)= KPT* SARF * V1 - KTP * A(4)\n\n;A(1) = DOSE\n;SARF = [SAR_LIBRE]\n;A(2) = [SARtot]*V1\n;A(3) = [PCSK9tot]*V1\n;A(4) = [L tissulaire]*V2\n\n; PCSK9SAR = TPCSK9 * SARF/(KSS + SARF) =&gt; surprediction possible du complexe au\n;tps initial !!!\n\n$ERROR\n\nIPRED=F\nSAV=0\nIF (IPRED.EQ.0) SAV=0.00001\nW=F\nIRES=DV-IPRED\nIWRES=IRES/(W+SAV)\n\nY=F+SQRT(TVEA*TVEA + TVEP*TVEP*F*F)*EPS(1)\n\n$THETA ( 0.0 0.20 1000000.0 ) ; TVCL\n$THETA ( 559 559 559 ) ; TKON\n$THETA ( 0.0 0.25 1000000.0 ) ; TKIN\n$THETA ( 0.0 2.00 1000000.0 ) ; TKDE\n$THETA ( 0.0 1.00 1000000.0 ) ; TVQ\n$THETA ( 2.0 4.00 1000000.0 ) ; TVV1 SART\n$THETA (   2.612   2.612       2.612 ) ; TVV2\n$THETA ( 0.0 0.50 1000000.0 ) ; TVKA\n$THETA (   0.550   0.750       1.000 ) ; TVF\n$THETA ( 0.0 0.30 1000000.0 ) ; TVEP\n$THETA ( 0.0 0.05 1000000.0 ) ; TVEA\n$THETA ( 0.0 0.05  100) ; LAG\n$THETA 1 ; COV1\n\n\n$OMEGA 0.5\n$OMEGA 0 FIX\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0 FIX\n$OMEGA 0.5\n$OMEGA 0.5\n\n$SIGMA  1 FIX\n\n\n; ================================================\n; PRIOR INFORMATION\n; ================================================\n; THETA Priors -------------------------\n$THETAP\n0.171896943763098     FIXED\n559                   FIXED\n0.123803201342408     FIXED\n1.34635526853289      FIXED\n0.50039445791587      FIXED\n3.22590460107421      FIXED\n2.612                 FIXED\n0.637779367431747     FIXED\n0.590001808531246     FIXED\n0.274684075637132     FIXED\n0.581795606608002     FIXED\n0.0298266165438046    FIXED\n1.56428570804632      FIXED\n; Variance to THETA priors -------------\n$THETAPV BLOCK(13)\n0.00023104719622956   FIXED\n1e-09                 1e-09                \n-1.04034957452488e-05 1e-09                 4.94852473541275e-06 \n-0.000132380576300711 1e-09                 -2.17038124549764e-06 0.0014067543164689   \n3.37273335283364e-05  1e-09                 -2.62117718892531e-05 -9.83509242784927e-05 0.00081696660001029  \n-0.000710872133743716 1e-09                 -5.80489374980969e-05 -0.000732628454663643 -0.000445920587930254 0.0415711705221499   \n1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                \n-0.000172472594375445 1e-09                 1.49084134799218e-05  0.000179969508697223  -0.000100076823054098 -0.00224596953903649  1e-09                 0.00218763549223713  \n8.79808997968756e-05  1e-09                 -2.09503076577778e-05 -0.000106886489009519 4.53146822800296e-05  0.00309692392362989   1e-09                 -0.000478502787321484 0.000572988006168684 \n-1.16269709887021e-06 1e-09                 6.45639736622959e-07  -1.04783992387998e-05 -4.49284209190946e-06 8.68593698728809e-06  1e-09                 2.1408518826492e-06   -2.72270313463236e-06 2.26505265649685e-06 \n3.97881008538303e-06  1e-09                 4.80556912014364e-07  2.78111595286765e-05  -3.57590444667545e-06 -4.77538174170191e-05 1e-09                 -6.15715850827622e-05 2.27771577491074e-06  -9.41191843254687e-06 0.000500919762819647 \n5.45053324304558e-07  1e-09                 -1.7273759122248e-07  -1.94999218108576e-07 3.31278452211055e-06  9.25019594253438e-07  1e-09                 -7.15492047000474e-07 5.74018896478916e-08  -1.6453046982605e-07  5.38469288515014e-06  1.20876103617239e-06 \n0.000507900274801002  1e-09                 -5.23098619372009e-05 -0.00029555530917814  0.000667518750332241  -0.0099825252948127   1e-09                 -0.000951749317422468 0.000240924919937593  -2.13162869496016e-05 3.10211676261024e-05  1.05759826160997e-06  0.00723573763017683  \n; OMEGA Priors -------------------------\n$OMEGAP\n0.279195982109823     FIXED\n0                     FIXED\n0.0580908084573451    FIXED\n0.170534475475969     FIXED\n0.0691065862986685    FIXED\n0.0990369682744904    FIXED\n0                     FIXED\n0.464462143306044     FIXED\n0.289551101707683     FIXED\n; Degrees of freedom of OMEGA Prior ----\n$OMEGAPD\n27                    FIXED ; ETCL\n0                     FIXED ; EKON\n316                   FIXED ; EKIN\n216                   FIXED ; EKDE\n11                    FIXED ; ETQ\n71                    FIXED ; ETV1\n0                     FIXED ; ETV2\n176                   FIXED ; ETKA\n33                    FIXED ; ETF\n; SIGMA Priors -------------------------\n$SIGMAP\n1                     FIXED\n; Degrees of freedom of SIGMA Prior ----\n$SIGMAPD\n0                     FIXED ; EPS1\n; ======================================\n$ESTIMATION METHOD=1 INTERACTION PRINT=1 MAXEVAL=9999 NOABORT POSTHOC\n\n$COVARIANCE PRINT=E MATRIX=S\n\n$TAB ID TIME DV IPRED PRED CMT IRES CWRES IWRES NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=sdtab\n$TAB ID TIME CL KON KSS KINT KDEG Q V1 V2 KA ALAG1 F1 ETAS(1:LAST) NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=patab\n$TAB ID TIME AGE WT BMI CLCR GFR BSLDLC TBSPCSK FBSPCSK NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=cotab\n$TAB ID TIME ISC DISST SEX FIBR EZE STATIN ARM ABDO THIGH STUD NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=catab\n"</div><div class='input'>
<span class='co'># Use prior information with "new_dataset.csv", set estimation to SAEM/IMP and</span>
<span class='co'># save the control stream to "new_study.ctl"</span>
<span class='fu'>nm_prior</span>(<span class='no'>EXAMPLERUN</span>,
         <span class='kw'>output_file</span> <span class='kw'>=</span> <span class='st'>"new_study.ctl"</span>,
         <span class='kw'>dataset_filename</span> <span class='kw'>=</span> <span class='st'>"new_dataset.csv"</span>,
         <span class='kw'>estimations</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"SAEM"</span>,
                                 <span class='st'>"INTERACTION"</span>, <span class='kw'>NBURN</span> <span class='kw'>=</span> <span class='fl'>400</span>, <span class='kw'>NITER</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
                                 <span class='kw'>PRINT</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='st'>"NOABORT"</span>, <span class='kw'>CTYPE</span> <span class='kw'>=</span> <span class='fl'>3</span>),
                            <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"IMP"</span>,
                                 <span class='kw'>NITER</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>PRINT</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                                 <span class='kw'>ISAMPLE</span> <span class='kw'>=</span> <span class='fl'>3000</span>, <span class='kw'>EONLY</span> <span class='kw'>=</span> <span class='fl'>1</span>)))</div><div class='output co'>#&gt; [1] "$PROB  TMDD Qss model for alirocumab\n; Reference:\n; Djebli N, Martinez JM, Lohan L, Khier S, Brunet A, Hurbin F, et al.\n; Target-mediated drug disposition population pharmacokinetics model of alirocumab in\n; healthy volunteers and patients: pooled analysis of randomized phase I/II/III studies.\n; Clin Pharmacokinet. 2017\n\n$INPUT ;; Edit $INPUT to match the new dataset columns\n$DATA new_dataset.csv IGNORE=@\n\n$SUBROUTINE ADVAN13 TOL=5\n\n$PRIOR NWPRI\n\n$MODEL NCOMP=4\nCOMP=(DEPOT)\nCOMP=(SARTOT)\nCOMP=(TPCSK9)\nCOMP=(PERIPH)\n\n$PK\n\nTVCL = THETA(1)\nTKON = THETA(2)\nTKIN = THETA(3)\nTKDE = THETA(4)\nTVQ  = THETA(5)\nTVV1 = THETA(6)\nTVV2 = THETA(7)\nTVKA = THETA(8)\nTVF  = THETA(9)\nTVEP = THETA(10)\nTVEA = THETA(11)\nTVLAG = THETA(12)\nCOV1   = THETA(13)\n\n\nETCL   = ETA(1)\nEKON   = ETA(2)\nEKIN   = ETA(3)\nEKDE   = ETA(4)\nETQ    = ETA(5)\nETV1   = ETA(6)\nETV2   = ETA(7)\nETKA   = ETA(8)\nETF    = ETA(9)\n\n\n\nCL   = TVCL * EXP(ETCL)\nKON  = TKON * EXP(EKON)\nKINT = TKIN * EXP(EKIN)\nKDEG = TKDE * EXP(EKDE)\nQ    = TVQ  * EXP(ETQ)\n\n\n\nCOV1V1 = TVV1 * COV1 ** DISST\n\nV1 = COV1V1 * EXP(ETV1)\n\nV2   = TVV2 * EXP(ETV2)\nKA   = TVKA * EXP(ETKA)\nALAG1 = TVLAG\n\nIF (ISC .EQ.0) THEN\n\nF1=1\nELSE\nPHI = LOG(TVF/(1-TVF))\nF1 = EXP(PHI+ETF)/(1+EXP(PHI+ETF))\nENDIF\n\nKEL = CL / V1\nKPT = Q / V1\nKTP = Q / V2\n\nKSS = 0.58 + KINT/KON\n\nSARBASE = 0\nKSYN = TBSPCSK * KDEG\n\nA_0(2) = SARBASE\nA_0(3) = TBSPCSK * V1\n\nS2=V1\nS3=V1\n\n\n\n$DES\nC2=A(2)/V1\nC3=A(3)/V1\nC4=A(4)/V2\nDADT(1)= -KA * A(1) * ISC * F1\n\nK1 = C2 - C3 - KSS\nSARF = 0.5*(K1+ SQRT(K1*K1 + 4*KSS*C2))\n\nDADT(2)= KA*A(1)*ISC*F1-(KEL+KPT)*SARF*V1-KINT*A(3)*SARF/(KSS+SARF)+KTP*C4*V2\n\nDADT(3)= KSYN  * V1 - KDEG * A(3)- (KINT - KDEG) * SARF * A(3)/(KSS + SARF)\n\nDADT(4)= KPT* SARF * V1 - KTP * A(4)\n\n;A(1) = DOSE\n;SARF = [SAR_LIBRE]\n;A(2) = [SARtot]*V1\n;A(3) = [PCSK9tot]*V1\n;A(4) = [L tissulaire]*V2\n\n; PCSK9SAR = TPCSK9 * SARF/(KSS + SARF) =&gt; surprediction possible du complexe au\n;tps initial !!!\n\n$ERROR\n\nIPRED=F\nSAV=0\nIF (IPRED.EQ.0) SAV=0.00001\nW=F\nIRES=DV-IPRED\nIWRES=IRES/(W+SAV)\n\nY=F+SQRT(TVEA*TVEA + TVEP*TVEP*F*F)*EPS(1)\n\n$THETA ( 0.0 0.20 1000000.0 ) ; TVCL\n$THETA ( 559 559 559 ) ; TKON\n$THETA ( 0.0 0.25 1000000.0 ) ; TKIN\n$THETA ( 0.0 2.00 1000000.0 ) ; TKDE\n$THETA ( 0.0 1.00 1000000.0 ) ; TVQ\n$THETA ( 2.0 4.00 1000000.0 ) ; TVV1 SART\n$THETA (   2.612   2.612       2.612 ) ; TVV2\n$THETA ( 0.0 0.50 1000000.0 ) ; TVKA\n$THETA (   0.550   0.750       1.000 ) ; TVF\n$THETA ( 0.0 0.30 1000000.0 ) ; TVEP\n$THETA ( 0.0 0.05 1000000.0 ) ; TVEA\n$THETA ( 0.0 0.05  100) ; LAG\n$THETA 1 ; COV1\n\n\n$OMEGA 0.5\n$OMEGA 0 FIX\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0.5\n$OMEGA 0 FIX\n$OMEGA 0.5\n$OMEGA 0.5\n\n$SIGMA  1 FIX\n\n\n; ================================================\n; PRIOR INFORMATION\n; ================================================\n; THETA Priors -------------------------\n$THETAP\n0.171896943763098     FIXED\n559                   FIXED\n0.123803201342408     FIXED\n1.34635526853289      FIXED\n0.50039445791587      FIXED\n3.22590460107421      FIXED\n2.612                 FIXED\n0.637779367431747     FIXED\n0.590001808531246     FIXED\n0.274684075637132     FIXED\n0.581795606608002     FIXED\n0.0298266165438046    FIXED\n1.56428570804632      FIXED\n; Variance to THETA priors -------------\n$THETAPV BLOCK(13)\n0.00023104719622956   FIXED\n1e-09                 1e-09                \n-1.04034957452488e-05 1e-09                 4.94852473541275e-06 \n-0.000132380576300711 1e-09                 -2.17038124549764e-06 0.0014067543164689   \n3.37273335283364e-05  1e-09                 -2.62117718892531e-05 -9.83509242784927e-05 0.00081696660001029  \n-0.000710872133743716 1e-09                 -5.80489374980969e-05 -0.000732628454663643 -0.000445920587930254 0.0415711705221499   \n1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                 1e-09                \n-0.000172472594375445 1e-09                 1.49084134799218e-05  0.000179969508697223  -0.000100076823054098 -0.00224596953903649  1e-09                 0.00218763549223713  \n8.79808997968756e-05  1e-09                 -2.09503076577778e-05 -0.000106886489009519 4.53146822800296e-05  0.00309692392362989   1e-09                 -0.000478502787321484 0.000572988006168684 \n-1.16269709887021e-06 1e-09                 6.45639736622959e-07  -1.04783992387998e-05 -4.49284209190946e-06 8.68593698728809e-06  1e-09                 2.1408518826492e-06   -2.72270313463236e-06 2.26505265649685e-06 \n3.97881008538303e-06  1e-09                 4.80556912014364e-07  2.78111595286765e-05  -3.57590444667545e-06 -4.77538174170191e-05 1e-09                 -6.15715850827622e-05 2.27771577491074e-06  -9.41191843254687e-06 0.000500919762819647 \n5.45053324304558e-07  1e-09                 -1.7273759122248e-07  -1.94999218108576e-07 3.31278452211055e-06  9.25019594253438e-07  1e-09                 -7.15492047000474e-07 5.74018896478916e-08  -1.6453046982605e-07  5.38469288515014e-06  1.20876103617239e-06 \n0.000507900274801002  1e-09                 -5.23098619372009e-05 -0.00029555530917814  0.000667518750332241  -0.0099825252948127   1e-09                 -0.000951749317422468 0.000240924919937593  -2.13162869496016e-05 3.10211676261024e-05  1.05759826160997e-06  0.00723573763017683  \n; OMEGA Priors -------------------------\n$OMEGAP\n0.279195982109823     FIXED\n0                     FIXED\n0.0580908084573451    FIXED\n0.170534475475969     FIXED\n0.0691065862986685    FIXED\n0.0990369682744904    FIXED\n0                     FIXED\n0.464462143306044     FIXED\n0.289551101707683     FIXED\n; Degrees of freedom of OMEGA Prior ----\n$OMEGAPD\n27                    FIXED ; ETCL\n0                     FIXED ; EKON\n316                   FIXED ; EKIN\n216                   FIXED ; EKDE\n11                    FIXED ; ETQ\n71                    FIXED ; ETV1\n0                     FIXED ; ETV2\n176                   FIXED ; ETKA\n33                    FIXED ; ETF\n; SIGMA Priors -------------------------\n$SIGMAP\n1                     FIXED\n; Degrees of freedom of SIGMA Prior ----\n$SIGMAPD\n0                     FIXED ; EPS1\n; ======================================\n$COVARIANCE PRINT=E MATRIX=S\n\n$ESTIMATION METHOD=SAEM INTERACTION NBURN=400 NITER=1000 PRINT=50 NOABORT CTYPE=3\n$ESTIMATION METHOD=IMP NITER=10 PRINT=1 ISAMPLE=3000 EONLY=1\n$TAB ID TIME DV IPRED PRED CMT IRES CWRES IWRES NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=sdtab\n$TAB ID TIME CL KON KSS KINT KDEG Q V1 V2 KA ALAG1 F1 ETAS(1:LAST) NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=patab\n$TAB ID TIME AGE WT BMI CLCR GFR BSLDLC TBSPCSK FBSPCSK NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=cotab\n$TAB ID TIME ISC DISST SEX FIBR EZE STATIN ARM ABDO THIGH STUD NOHEADER NOPRINT NOAPPEND FORMAT=,1PE11.4 FILE=catab\n"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='mailto:patrick.nolain@sanofi.com'>Patrick Nolain</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

